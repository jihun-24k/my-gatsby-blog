---
title: Spring Batch(ìŠ¤í”„ë§ ë°°ì¹˜)
date: 2022-11-23
tags:
  - springboot
  - batch
---

### Batchë€

ëŒ€ìš©ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì‹¤ì‹œê°„ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ ì•„ë‹ˆë¼ ì¼ê´„ì ìœ¼ë¡œ ëª¨ì•„ì„œ ì‘ì—…í•˜ëŠ” ê²ƒì„ ë°°ì¹˜ ì‘ì—…ì´ë¼ê³  í•œë‹¤. ì˜ˆë¥¼ ë“¤ì–´ ë¡œê·¸ì¸ì€ ê°ê° ê°œë³„ì ì¸ ì²˜ë¦¬ë¥¼ í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ì§€ë§Œ ëª¨ë“  íšŒì›ì—ê²Œ ë©”ì¼ì„ ë³´ë‚´ëŠ” ì‘ì—…ì€ ì¼ê´„ì ìœ¼ë¡œ ì²˜ë¦¬í•˜ëŠ” ê²ƒì´ íš¨ìœ¨ì ì´ë‹¤. ì´ë ‡ë“¯ ë°°ì¹˜ ì‘ì—…ì€ ì¼ë°˜ì ìœ¼ë¡œ, ì •í•´ì§„ ì‹œê°„ì— ëŒ€ëŸ‰ì˜ ë°ì´í„°ë¥¼ ì¼ê´„ì ìœ¼ë¡œ ì²˜ë¦¬í•œë‹¤ë¼ê³ ë„ ì •ì˜í•  ìˆ˜ ìˆë‹¤.

#### Spring Batch êµ¬ì¡°

![](batch.png)

- JobRepostitoryë‚˜ JobLauncherëŠ” ê±´ë“œë¦¬ì§€ ì•Šì•„ë„ ëœë‹¤.
- jobì´ë‚˜ step, í•˜ìœ„ í´ë˜ìŠ¤ë“¤ì„ ê°œë°œí•œë‹¤.
- jobì€ ì—¬ëŸ¬ê°œì˜ stepë“¤ë¡œ êµ¬ì„±ëœë‹¤.
- jobì€ ë˜‘ê°™ì€ ì¡°ê±´ì´ë©´ ë‹¤ì‹œ ì‹¤í–‰ë˜ì§€ ì•ŠëŠ”ë‹¤.
    - ì˜ˆë¥¼ë“¤ì–´ í•œë²ˆ ì‹¤í–‰í–ˆë˜ ì‘ì—…ì´ ìˆë‹¤ë©´ ê·¸ ì •ë³´ë¥¼ ë”°ë¡œ ì €ì¥í•´ ì¬ì‹¤í–‰ ì—¬ë¶€ë¥¼ ì •í•œë‹¤.

#### Batch ì£¼ìš” ìš©ì–´

1. **Job**
    
    ì‹¤í–‰ì‹œí‚¬ ì‘ì—…ì„ ì˜ë¯¸ë¡œ, ë…¼ë¦¬ì ì¸ Job ì‹¤í–‰ì˜ ê°œë…ì´ë‹¤.
    
2. **batch ë©”íƒ€ í…Œì´ë¸”**
    - spring batchê°€ ì œê³µí•˜ëŠ” ê°€ì¥ ê¸°ë³¸ì ì¸ ê¸°ëŠ¥
    - ë°°ì¹˜ ì‘ì—… í•˜ëŠ”ë™ì•ˆ ì‚¬ìš©ë˜ëŠ” ëª¨ë“  ë©”íƒ€ì •ë³´ë“¤ì„ ì €ì¥
        - ì˜ˆë¥¼ë“¤ì–´ ì‘ì—…ì‹œê°„, íŒŒë¼ë¯¸í„°, ì •ìƒìˆ˜í–‰ ì—¬ë¶€
    - ì´ë¥¼ í†µí•œ ëª¨ë‹ˆí„°ë§ ìš©ë„ë¡œ ì‚¬ìš©ê°€ëŠ¥
3. **Step**
    
    Job ë‚´ë¶€ì—ì„œ ìˆ˜í–‰ë  1ê°œì˜ step
    


#### ğŸŒŸTasklet vs Chunk
ê°„ë‹¨í•˜ê²ŒëŠ” Tasklet, ìŠ¤í”„ë§ë°°ì¹˜ëŠ” Chunk ì§€í–¥

- Task ê¸°ë°˜: í•˜ë‚˜ì˜ ì‘ì—… ê¸°ë°˜ìœ¼ë¡œ ì‹¤í–‰
- Chunk ê¸°ë°˜: í•˜ë‚˜ì˜ í° ë©ì–´ë¦¬ë¥¼ në²ˆì”© ë‚˜ëˆ ì„œ ì‹¤í–‰



#### ë°°ì¹˜ ì‹¤ìŠµ í™˜ê²½

![](spring-batch.png)
#### ë°°ì¹˜ì•±ìœ¼ë¡œ ë“±ë¡

@EnableBatchProcessing ì• ë„ˆí…Œì´ì…˜ì„ ê¼­ ë¶™ì—¬ì¤˜ì•¼ì§€ ì‘ì—…ì´ ì§„í–‰ëœë‹¤. 

```java
@SpringBootApplication
@EnableBatchProcessing
public class SpringBatchTestApplication {

	public static void main(String[] args) {
		SpringApplication.run(SpringBatchTestApplication.class, args);
	}

}
```

#### ë°°ì¹˜ Jobì„ ìƒì„±

```java
@Configuration
@RequiredArgsConstructor
public class HelloWorldJobConfig {

    @Autowired
    private JobBuilderFactory jobBuilderFactory;

    @Autowired
    private StepBuilderFactory stepBuilderFactory;

    @Bean
    public Job helloWorldJob() {
        return jobBuilderFactory.get("helloWorldJob")
                .start(helloWorldStep())
                .build();
    }

    @JobScope
    @Bean
    public Step helloWorldStep1() {
        return stepBuilderFactory.get("helloWorldStep1")
                .tasklet(helloWorldTasklet())
                .build();
    }

    @StepScope
    @Bean
    public Tasklet helloWorldTasklet() {
        return new Tasklet() {
            @Override
            public RepeatStatus execute(StepContribution contribution, ChunkContext chunkContext) throws Exception {
                System.out.println("ìŠ¤í”„ë§ ë°°ì¹˜");
                return RepeatStatus.FINISHED;
            }
        };
    }
}
```

#### ${job.name} ì˜ë¯¸

Job ì˜ í™˜ê²½ë³€ìˆ˜ëª…ì„ ì°¸ì¡°í•˜ëŠ” êµ¬ë¬¸ì´ë‹¤. ë§Œì¼ ì—†ë‹¤ë©´ ì¡°ê±´ì„ ê±¸ì–´ì¤„ ìˆ˜ ìˆëŠ”ë° ì´ë²ˆ HelloWorld ì‹¤ìŠµì—ì„  helloworldJobì„ ì ì–´ì¤¬ë‹¤.

```yaml
spring:
  batch:
    job:
      names: ${job.name:helloWorldJob}
    jdbc:
      initialize-schema: ALWAYS
  datasource:
    url: jdbc:mariadb://127.0.0.1:3306/app_2022_09_22?useUnicode=true&characterEncoding=utf8&autoReconnect=true&serverTimezone=Asia/Seoul
    driver-class-name:
    username: root
    password: roger3495
  jpa:
    show-sql: true
```  

#### ê²°ê³¼í™”ë©´
![](batch-result.png)  

  
#### ì°¸ê³ 

[SpringBoot Batch ì •ë¦¬](https://velog.io/@mooh2jj/SpringBoot-Batch)